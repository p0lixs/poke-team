<div class="team-panel">
  <div class="team-header">
    <h2>Your team</h2>
    <button class="btn-clear" type="button" (click)="clear.emit()" [disabled]="!team.length">Clear</button>
  </div>

  <div class="team-controls">
    <!-- Select/Input block + button group -->
    <label class="control">
      <span>Teams</span>
      <div class="select-wrapper">
        @if (editMode === 'none') {
        <!-- SELECT without the "New" option -->
        <select [ngModel]="selectedTeamId ?? ''" (ngModelChange)="onSelectChange($event)">
          @for (saved of savedTeams; track trackTeamId($index, saved)) {
          <option [value]="saved.id">{{ saved.name }}</option>
          }
        </select>
        } @else {
        <!-- INPUT when Add or Edit is pressed -->
        <input type="text" [ngModel]="tempName" (ngModelChange)="tempName = $event"
          placeholder="@{{ editMode === 'add' ? 'New team name' : 'New name for the team' }}" />
        }
        @if (editMode === 'none') {
        <div class="btn-group">
          <button class="btn save" type="button" (click)="startAdd()">Add</button>
          <button class="btn save" type="button" (click)="startEdit()" [disabled]="!selectedTeamId">Edit</button>
        </div>
        } @else {
        <div class="btn-group">
          <button class="btn save" type="button" (click)="confirm()" [disabled]="!tempName.trim()">Save</button>
          <button class="btn cancel" type="button" (click)="cancelEdit()">Cancel</button>
        </div>
        }
      </div>
    </label>

    <div class="import-export">
      <button class="btn secondary" type="button" (click)="openImport.emit()">Import</button>
      <button class="btn secondary" type="button" (click)="openExport.emit()" [disabled]="!team.length">
        Export
      </button>
      <button class="btn secondary" type="button" (click)="openWeaknesses.emit()" [disabled]="!team.length">
        Weaknesses
      </button>
    </div>


  </div>

  @if (team.length) {
  <div class="team-grid">
    @for (p of team; track trackById($index, p)) {
    <app-pokemon
      [pokemon]="p"
      [items]="items"
      [natures]="natures"
      (remove)="remove.emit($event)"
      (moveChange)="moveChange.emit($event)"
      (abilityChange)="abilityChange.emit($event)"
      (itemChange)="itemChange.emit($event)"
      (natureChange)="natureChange.emit($event)"
      (levelChange)="levelChange.emit($event)"
      (statChange)="statChange.emit($event)"
      (teraTypeChange)="teraTypeChange.emit($event)"
    ></app-pokemon>
    }
  </div>
  } @else {
  <p class="muted">You have not added any Pok√©mon yet.</p>
  }
</div>
